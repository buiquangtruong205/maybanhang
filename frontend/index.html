<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M√°y B√°n H√†ng T·ª± ƒê·ªông</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <span class="logo-icon">üè™</span>
                <h1>Vending Machine</h1>
            </div>
            <div class="header-right">
                <span class="clock" id="clock"></span>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-container">
        <!-- Products Section -->
        <section class="products-section">
            <h2 class="section-title">
                <span class="title-icon">üõí</span>
                Ch·ªçn S·∫£n Ph·∫©m
            </h2>
            <div class="products-grid" id="products-grid">
                <!-- Products will be loaded here -->
                <div class="loading-spinner">
                    <div class="spinner"></div>
                    <p>ƒêang t·∫£i s·∫£n ph·∫©m...</p>
                </div>
            </div>
        </section>

        <!-- Cart Section -->
        <section class="cart-section">
            <h2 class="section-title">
                <span class="title-icon">üßæ</span>
                ƒê∆°n H√†ng
                <span class="cart-badge" id="cart-count">0</span>
            </h2>
            <div class="cart-items" id="cart-items">
                <div class="empty-cart">
                    <span class="empty-icon">üì¶</span>
                    <p>Ch∆∞a c√≥ s·∫£n ph·∫©m n√†o</p>
                </div>
            </div>
            <div class="cart-total">
                <span>T·ªïng c·ªông:</span>
                <span class="total-amount" id="total-amount">0 ‚Ç´</span>
            </div>
            <button class="checkout-btn" id="checkout-btn" disabled>
                <span class="btn-icon">üí≥</span>
                Thanh To√°n
            </button>
        </section>
    </main>

    <!-- QR Payment Modal -->
    <div class="modal" id="qr-modal">
        <div class="modal-overlay"></div>
        <div class="modal-content qr-modal-content">
            <div class="modal-header">
                <h3>Qu√©t M√£ QR ƒê·ªÉ Thanh To√°n</h3>
                <button class="modal-close" id="qr-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="qr-container">
                    <img class="qr-code" id="qr-code" src="" alt="QR Code">
                </div>
                <div class="payment-info">
                    <p class="order-code">M√£ ƒë∆°n h√†ng: <strong id="order-code-display">---</strong></p>
                    <p class="payment-amount">S·ªë ti·ªÅn: <strong id="payment-amount-display">0 ‚Ç´</strong></p>
                </div>
                <div class="payment-status" id="payment-status">
                    <div class="status-waiting">
                        <div class="pulse-ring"></div>
                        <span>ƒêang ch·ªù thanh to√°n...</span>
                    </div>
                </div>
                <div class="payment-timer">
                    <span>Th·ªùi gian c√≤n l·∫°i: </span>
                    <span id="countdown">05:00</span>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" id="cancel-payment-btn">H·ªßy Thanh To√°n</button>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div class="modal" id="success-modal">
        <div class="modal-overlay"></div>
        <div class="modal-content success-modal-content">
            <div class="success-animation">
                <div class="checkmark-circle">
                    <div class="checkmark"></div>
                </div>
            </div>
            <h3>Thanh To√°n Th√†nh C√¥ng!</h3>
            <p class="success-message">C·∫£m ∆°n b·∫°n ƒë√£ mua h√†ng</p>
            <p class="success-order">ƒê∆°n h√†ng: <strong id="success-order-code">---</strong></p>
            <button class="btn-primary" id="success-close-btn">Ti·∫øp T·ª•c Mua H√†ng</button>
        </div>
    </div>

    <!-- IoT Simulation Panel -->
    <div class="iot-panel" id="iot-panel">
        <div class="iot-panel-header">
            <span class="iot-icon">üìü</span>
            <span>Nh·∫≠t k√Ω thi·∫øt b·ªã</span>
            <button class="iot-toggle" id="iot-toggle">‚ñº</button>
        </div>
        <div class="iot-panel-body" id="iot-panel-body">
            <div class="iot-log" id="iot-log">
                <div class="log-title">üìú Nh·∫≠t k√Ω h·ªá th·ªëng:</div>
                <div class="log-content" id="log-content"></div>
            </div>

            <div class="iot-section"
                style="margin-top: 1rem; border-top: 1px solid var(--border-color); padding-top: 1rem;">
                <h4>üîç Ki·ªÉm tra tr·∫°ng th√°i thi·∫øt b·ªã</h4>
                <div class="security-buttons">
                    <button class="iot-btn" onclick="checkDeviceIdentity()">
                        üÜî Ki·ªÉm tra ƒë·ªãnh danh
                    </button>
                    <button class="iot-btn" onclick="checkDeviceSession()">
                        üîë Ki·ªÉm tra phi√™n
                    </button>
                    <button class="iot-btn" onclick="sendHeartbeat()">
                        üíì G·ª≠i Heartbeat
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Error Toast -->
    <div class="toast" id="error-toast">
        <span class="toast-icon">‚ö†Ô∏è</span>
        <span class="toast-message" id="toast-message"></span>
    </div>

    <!-- Socket.IO client for real-time payment notifications -->
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script src="script.js"></script>
</body>

</html>